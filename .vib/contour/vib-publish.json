{
  "phases": {
    "package": {
      "context": {
        "resources": {
          "url": "{SHA_ARCHIVE}",
          "path": "/bitnami/contour"
        }
      },
      "actions": [
        {
          "action_id": "helm-package"
        },
        {
          "action_id": "helm-lint"
        }
      ]
    },
    "verify": {
      "context": {
        "resources": {
          "url": "{SHA_ARCHIVE}",
          "path": "/bitnami/contour"
        },
        "runtime_parameters": "Y29udG91cjoKICBzZXJ2aWNlQWNjb3VudDoKICAgIGNyZWF0ZTogdHJ1ZQogICAgYXV0b21vdW50U2VydmljZUFjY291bnRUb2tlbjogdHJ1ZQogIHBvZFNlY3VyaXR5Q29udGV4dDoKICAgIGVuYWJsZWQ6IHRydWUKICAgIGZzR3JvdXA6IDEwMDIKICBjb250YWluZXJTZWN1cml0eUNvbnRleHQ6CiAgICBlbmFibGVkOiB0cnVlCiAgICBydW5Bc1VzZXI6IDEwMDIKICBzZXJ2aWNlOgogICAgcG9ydHM6CiAgICAgIHhkczogODAKICAgIHR5cGU6IExvYWRCYWxhbmNlcgplbnZveToKICBlbmFibGVkOiB0cnVlCiAgc2VydmljZToKICAgIHR5cGU6IENsdXN0ZXJJUAogICAgZXh0ZXJuYWxUcmFmZmljUG9saWN5OiAiIgogICAgcG9ydHM6CiAgICAgIGh0dHA6IDgwCmV4dHJhRGVwbG95OgotIGFwaVZlcnNpb246IGFwcHMvdjEKICBraW5kOiBEZXBsb3ltZW50CiAgbWV0YWRhdGE6CiAgICBsYWJlbHM6CiAgICAgIGFwcDoga3VhcmQKICAgIG5hbWU6IGt1YXJkCiAgc3BlYzoKICAgIHJlcGxpY2FzOiAzCiAgICBzZWxlY3RvcjoKICAgICAgbWF0Y2hMYWJlbHM6CiAgICAgICAgYXBwOiBrdWFyZAogICAgdGVtcGxhdGU6CiAgICAgIG1ldGFkYXRhOgogICAgICAgIGxhYmVsczoKICAgICAgICAgIGFwcDoga3VhcmQKICAgICAgc3BlYzoKICAgICAgICBjb250YWluZXJzOgogICAgICAgIC0gaW1hZ2U6IGdjci5pby9rdWFyLWRlbW8va3VhcmQtYW1kNjQ6MQogICAgICAgICAgbmFtZToga3VhcmQKLSBhcGlWZXJzaW9uOiB2MQogIGtpbmQ6IFNlcnZpY2UKICBtZXRhZGF0YToKICAgIGxhYmVsczoKICAgICAgYXBwOiBrdWFyZAogICAgbmFtZToga3VhcmQKICBzcGVjOgogICAgcG9ydHM6CiAgICAtIHBvcnQ6IDgwCiAgICAgIHByb3RvY29sOiBUQ1AKICAgICAgdGFyZ2V0UG9ydDogODA4MAogICAgc2VsZWN0b3I6CiAgICAgIGFwcDoga3VhcmQKICAgIHNlc3Npb25BZmZpbml0eTogTm9uZQogICAgdHlwZTogQ2x1c3RlcklQCi0gYXBpVmVyc2lvbjogbmV0d29ya2luZy5rOHMuaW8vdjEKICBraW5kOiBJbmdyZXNzCiAgbWV0YWRhdGE6CiAgICBuYW1lOiBrdWFyZAogICAgbGFiZWxzOgogICAgICBhcHA6IGt1YXJkCiAgc3BlYzoKICAgIGRlZmF1bHRCYWNrZW5kOgogICAgICBzZXJ2aWNlOgogICAgICAgIG5hbWU6IGt1YXJkCiAgICAgICAgcG9ydDoKICAgICAgICAgIG51bWJlcjogODA=",
        "target_platform": {
          "target_platform_id": "{VIB_ENV_ALTERNATIVE_TARGET_PLATFORM}",
          "size": {
            "name": "S4"
          }
        }
      },
      "actions": [
        {
          "action_id": "health-check",
          "params": {
            "endpoint": "lb-contour-tcp-xds"
          }
        },
        {
          "action_id": "goss",
          "params": {
            "resources": {
              "path": "/.vib/contour/goss"
            },
            "remote": {
              "workload": "deploy-contour-contour"
            },
            "vars_file": "vars.yaml"
          }
        },
        {
          "action_id": "ginkgo",
          "params": {
            "resources": {
              "path": "/.vib/contour/ginkgo"

            },
            "params": {
              "kubeconfig": "{{kubeconfig}}",
              "namespace": "{{namespace}}"
            }
          }
        }
      ]
    },
    "publish": {
      "actions": [
        {
          "action_id": "helm-publish",
          "params": {
            "repository": {
              "kind": "S3",
              "url": "{VIB_ENV_S3_URL}",
              "username": "{VIB_ENV_S3_USERNAME}",
              "password": "{VIB_ENV_S3_PASSWORD}"
            }
          }
        }
      ]
    }
  }
}
