apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "redis.fullname" . }}
  labels: {{- include "redis.labels" . | nindent 4 }}
data:
  redis.conf: |-
    dir {{ .Values.persistence.path }}
    port {{ .Values.redisPort }}
{{- if .Values.cluster.enabled }}
    cluster-enabled yes
    cluster-config-file /data/nodes.conf
{{- end }}
    appendonly yes
{{- if .Values.configmap }}
{{- include "redis.tplValue" (dict "value" .Values.configmap "context" $) | nindent 4 }}
{{- end }}
